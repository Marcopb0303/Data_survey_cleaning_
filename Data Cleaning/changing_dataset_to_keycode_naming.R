library(dplyr)
library(janitor)

data <- readRDS("crew_survey_cleaned_fixed.rds")
data <- data %>% clean_names()

# current_cols <- colnames(data)
# cat("Current number of columns after clean_names():", length(current_cols), "\n")

cleaned_to_keycode <- c(
  "response_id" = "id",
  "date_submitted" = "submitdate",
  "last_page" = "lastpage",
  "start_language" = "startlanguage",
  "seed" = "seed",
  "date_started" = "startdate",
  "date_last_action" = "datestamp",
  "referrer_url" = "refurl",
  "crew_network_conducts_this_benchmarking_study_every_5_years_please_indicate_below_if_you_took_the_benchmarking_survey_in_prior_years_i_took_this_survey_in_2010" = "i0[2]",
  "crew_network_conducts_this_benchmarking_study_every_5_years_please_indicate_below_if_you_took_the_benchmarking_survey_in_prior_years_i_took_this_survey_in_2015" = "i0[3]",
  "crew_network_conducts_this_benchmarking_study_every_5_years_please_indicate_below_if_you_took_the_benchmarking_survey_in_prior_years_i_took_this_survey_in_2020" = "i0[6]",
  "crew_network_conducts_this_benchmarking_study_every_5_years_please_indicate_below_if_you_took_the_benchmarking_survey_in_prior_years_i_have_not_taken_this_survey_before" = "i0[4]",
  "crew_network_conducts_this_benchmarking_study_every_5_years_please_indicate_below_if_you_took_the_benchmarking_survey_in_prior_years_i_have_taken_it_before_but_i_am_not_sure_when" = "i0[5]",
  "please_select_the_affiliation_through_which_you_are_receiving_this_survey" = "i1",
  "please_select_the_affiliation_through_which_you_are_receiving_this_survey_other" = "i1[other]",
  "are_you_currently_employed" = "i2",
  "how_long_have_you_been_out_of_the_workforce" = "i3",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_select_all_that_apply_education" = "i4[SQ001]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_select_all_that_apply_travel" = "i4[SQ002]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_select_all_that_apply_personal_illness" = "i4[SQ003]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_select_all_that_apply_family_care" = "i4[SQ004]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_select_all_that_apply_new_child" = "i4[SQ005]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_select_all_that_apply_involuntary_time_between_jobs_unemployment" = "i4[SQ006]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_select_all_that_apply_voluntary_time_between_jobs" = "i4[SQ007]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_select_all_that_apply_retirement" = "i4[SQ012]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_select_all_that_apply_circumstances_related_to_the_pandemic" = "i4[SQ010]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_select_all_that_apply_other" = "i4[SQ015]",
  "what_is_your_company_s_primary_industry_for_the_following_questions_if_you_are_currently_out_of_work_please_respond_as_if_you_still_worked_for_your_former_company" = "m1A",
  "what_is_your_company_s_primary_industry_for_the_following_questions_if_you_are_currently_out_of_work_please_respond_as_if_you_still_worked_for_your_former_company_other" = "m1A[other]",
  "within_the_company_for_which_you_currently_work_what_do_you_consider_your_primary_area_of_specialization_select_the_option_that_most_closely_aligns_with_your_role" = "m1B",
  "within_the_company_for_which_you_currently_work_what_do_you_consider_your_primary_area_of_specialization_select_the_option_that_most_closely_aligns_with_your_role_other" = "m1B[other]",
  "in_your_current_role_which_type_of_commercial_real_estate_is_your_primary_focus_you_may_select_multiple_categories_if_you_regularly_deal_with_multiple_types_of_commercial_real_estate_office" = "m2B[SQ001]",
  "in_your_current_role_which_type_of_commercial_real_estate_is_your_primary_focus_you_may_select_multiple_categories_if_you_regularly_deal_with_multiple_types_of_commercial_real_estate_industrial_manufacturing" = "m2B[SQ002]",
  "in_your_current_role_which_type_of_commercial_real_estate_is_your_primary_focus_you_may_select_multiple_categories_if_you_regularly_deal_with_multiple_types_of_commercial_real_estate_retail" = "m2B[SQ003]",
  "in_your_current_role_which_type_of_commercial_real_estate_is_your_primary_focus_you_may_select_multiple_categories_if_you_regularly_deal_with_multiple_types_of_commercial_real_estate_multi_family" = "m2B[SQ004]",
  "in_your_current_role_which_type_of_commercial_real_estate_is_your_primary_focus_you_may_select_multiple_categories_if_you_regularly_deal_with_multiple_types_of_commercial_real_estate_hotel_motel_hospitality" = "m2B[SQ005]",
  "in_your_current_role_which_type_of_commercial_real_estate_is_your_primary_focus_you_may_select_multiple_categories_if_you_regularly_deal_with_multiple_types_of_commercial_real_estate_mixed_use" = "m2B[SQ006]",
  "in_your_current_role_which_type_of_commercial_real_estate_is_your_primary_focus_you_may_select_multiple_categories_if_you_regularly_deal_with_multiple_types_of_commercial_real_estate_health_care" = "m2B[SQ007]",
  "in_your_current_role_which_type_of_commercial_real_estate_is_your_primary_focus_you_may_select_multiple_categories_if_you_regularly_deal_with_multiple_types_of_commercial_real_estate_education" = "m2B[SQ008]",
  "in_your_current_role_which_type_of_commercial_real_estate_is_your_primary_focus_you_may_select_multiple_categories_if_you_regularly_deal_with_multiple_types_of_commercial_real_estate_public_sector" = "m2B[SQ009]",
  "in_your_current_role_which_type_of_commercial_real_estate_is_your_primary_focus_you_may_select_multiple_categories_if_you_regularly_deal_with_multiple_types_of_commercial_real_estate_other" = "m2B[other]",
  "in_which_country_are_you_located" = "WHEREFROM",
  "which_of_the_following_best_describes_your_current_position_please_read_all_options_completely_before_selecting" = "m3A",
  "what_motivated_you_to_establish_your_own_business_please_fill_in_all_rows_more_flexible_work_hours_or_arrangements" = "m3E[1]",
  "what_motivated_you_to_establish_your_own_business_please_fill_in_all_rows_better_earnings_potential" = "m3E[2]",
  "what_motivated_you_to_establish_your_own_business_please_fill_in_all_rows_wanted_more_control_authority" = "m3E[3]",
  "what_motivated_you_to_establish_your_own_business_please_fill_in_all_rows_desire_to_leave_previous_employer" = "m3E[4]",
  "what_motivated_you_to_establish_your_own_business_please_fill_in_all_rows_unable_to_find_suitable_work" = "m3E[5]",
  "what_motivated_you_to_establish_your_own_business_please_fill_in_all_rows_opportunities_limited_at_previous_employer" = "m3E[6]",
  "what_motivated_you_to_establish_your_own_business_please_fill_in_all_rows_laid_off" = "m3E[7]",
  "what_motivated_you_to_establish_your_own_business_please_fill_in_all_rows_circumstances_related_to_the_pandemic" = "m3E[8]",
  "how_long_have_you_actively_worked_in_a_role_related_to_commercial_real_estate_please_do_not_include_time_employed_in_roles_not_related_to_commercial_real_estate_or_gaps_in_employment" = "m4A",
  "how_long_have_you_actively_worked_in_a_role_related_to_commercial_real_estate_please_do_not_include_time_employed_in_roles_not_related_to_commercial_real_estate_or_gaps_in_employment_other" = "m4A[other]",
  "what_level_of_management_do_you_aspire_to_reach_at_the_peak_of_your_career" = "m4C",
  "how_many_times_during_your_commercial_real_estate_career_have_you_transitioned_to_new_companies" = "m4D",
  "which_of_the_following_statements_best_describes_your_career" = "m5",
  "how_long_have_you_worked_at_your_current_location" = "m7A",
  "how_long_have_you_worked_at_your_current_location_other" = "m7A[other]",
  "major_market_area_in_which_you_work" = "m7Bii",
  "what_is_your_entire_company_s_approximate_annual_revenue" = "m29",
  "approximately_how_many_employees_work_for_your_company_at_your_location_please_include_yourself" = "m8",
  "which_of_the_following_best_describes_your_company" = "m30A",
  "what_is_the_ownership_structure_that_best_describes_your_company" = "m30B",
  "approximately_how_many_professionals_at_your_current_location_work_in_commercial_real_estate_please_include_yourself" = "m9A",
  "of_the_insertans_714832x449x6418_professionals_in_commercial_real_estate_at_your_current_location_approximately_what_percentage_identify_as_if_you_are_unsure_about_the_exact_answer_please_provide_your_best_estimate_male" = "m9C[SQ001]",
  "of_the_insertans_714832x449x6418_professionals_in_commercial_real_estate_at_your_current_location_approximately_what_percentage_identify_as_if_you_are_unsure_about_the_exact_answer_please_provide_your_best_estimate_female" = "m9C[SQ002]",
  "of_the_insertans_714832x449x6418_professionals_in_commercial_real_estate_at_your_current_location_approximately_what_percentage_identify_as_if_you_are_unsure_about_the_exact_answer_please_provide_your_best_estimate_nonbinary_gender_variant" = "m9C[SQ003]",
  "of_the_insertans_714832x449x6418_professionals_in_commercial_real_estate_at_your_current_location_approximately_how_many_identify_as_if_you_are_unsure_about_the_exact_answer_please_provide_your_best_estimate_female" = "G06Q77[SQ001]",
  "of_the_insertans_714832x449x6418_professionals_in_commercial_real_estate_at_your_current_location_approximately_how_many_identify_as_if_you_are_unsure_about_the_exact_answer_please_provide_your_best_estimate_male" = "G06Q77[SQ002]",
  "of_the_insertans_714832x449x6418_professionals_in_commercial_real_estate_at_your_current_location_approximately_how_many_identify_as_if_you_are_unsure_about_the_exact_answer_please_provide_your_best_estimate_non_binary_gender_variant" = "G06Q77[SQ003]",
  "approximately_how_many_professionals_at_your_current_location_work_in_your_specialization_please_include_yourself" = "m9E",
  "of_the_insertans_714832x450x6420_professionals_in_your_specialization_at_your_current_location_approximately_what_percentage_identify_as_if_you_dont_know_please_give_your_best_estimate_male" = "m9G[SQ001]",
  "of_the_insertans_714832x450x6420_professionals_in_your_specialization_at_your_current_location_approximately_what_percentage_identify_as_if_you_dont_know_please_give_your_best_estimate_female" = "m9G[SQ002]",
  "of_the_insertans_714832x450x6420_professionals_in_your_specialization_at_your_current_location_approximately_what_percentage_identify_as_if_you_dont_know_please_give_your_best_estimate_nonbinary_gender_variant" = "m9G[SQ003]",
  "of_the_insertans_714832x450x6420_professionals_in_your_specialization_at_your_current_location_approximately_how_many_identify_as_if_you_dont_know_please_give_your_best_estimate_female" = "G07Q74[SQ001]",
  "of_the_insertans_714832x450x6420_professionals_in_your_specialization_at_your_current_location_approximately_how_many_identify_as_if_you_dont_know_please_give_your_best_estimate_male" = "G07Q74[SQ002]",
  "of_the_insertans_714832x450x6420_professionals_in_your_specialization_at_your_current_location_approximately_how_many_identify_as_if_you_dont_know_please_give_your_best_estimate_non_binary_gender_variant" = "G07Q74[SQ003]",
  "approximately_how_many_senior_level_roles_in_your_specialization_reporting_to_a_vice_president_or_higher_are_there_at_your_current_location" = "m10A",
  "thinking_only_about_the_insertans_714832x452x6422_senior_level_or_higher_roles_within_your_specialization_at_your_current_location_approximately_what_percent_of_them_identify_as_male" = "m10C[SQ001]",
  "thinking_only_about_the_insertans_714832x452x6422_senior_level_or_higher_roles_within_your_specialization_at_your_current_location_approximately_what_percent_of_them_identify_as_female" = "m10C[SQ002]",
  "thinking_only_about_the_insertans_714832x452x6422_senior_level_or_higher_roles_within_your_specialization_at_your_current_location_approximately_what_percent_of_them_identify_as_non_binary_gender_variant" = "m10C[SQ003]",
  "thinking_only_about_the_insertans_714832x452x6422_senior_level_or_higher_roles_within_your_specialization_at_your_current_location_approximately_how_many_identify_as_female" = "G09Q75[SQ001]",
  "thinking_only_about_the_insertans_714832x452x6422_senior_level_or_higher_roles_within_your_specialization_at_your_current_location_approximately_how_many_identify_as_male" = "G09Q75[SQ002]",
  "thinking_only_about_the_insertans_714832x452x6422_senior_level_or_higher_roles_within_your_specialization_at_your_current_location_approximately_how_many_identify_as_non_binary_gender_variant" = "G09Q75[SQ003]",
  "in_your_current_position_does_anyone_report_directly_to_you" = "m11A",
  "how_many_individuals_report_to_you" = "G10Q78",
  "of_the_people_who_report_directly_to_you_approximately_what_percent_identify_as_male" = "m11B[SQ001]",
  "of_the_people_who_report_directly_to_you_approximately_what_percent_identify_as_female" = "m11B[SQ002]",
  "of_the_people_who_report_directly_to_you_approximately_what_percent_identify_as_nonbinary_gender_variant" = "m11B[SQ003]",
  "of_the_people_who_report_directly_to_you_approximately_how_many_identify_as_female" = "G10Q76[SQ001]",
  "of_the_people_who_report_directly_to_you_approximately_how_many_identify_as_male" = "G10Q76[SQ002]",
  "of_the_people_who_report_directly_to_you_approximately_how_many_identify_as_non_binary_gender_variant" = "G10Q76[SQ003]",
  "while_working_in_commercial_real_estate_how_many_times_have_you_accepted_a_promotion_to_a_higher_level_position" = "m12A[SQ001]",
  "while_working_in_commercial_real_estate_how_many_times_have_you_turned_down_a_promotion_to_a_higher_level_position" = "m12A[SQ002]",
  "while_working_in_commercial_real_estate_how_many_times_have_you_accepted_a_lateral_move_to_a_position_with_different_responsibilities" = "m12A[SQ003]",
  "while_working_in_commercial_real_estate_how_many_times_have_you_turned_down_a_lateral_move_to_a_position_with_different_responsibilities" = "m12A[SQ004]",
  "thinking_of_your_career_in_commercial_real_estate_for_which_of_the_following_reasons_have_you_taken_jobs_with_new_companies_you_may_select_multiple_categories_you_were_looking_for_a_change" = "m12C[SQ001]",
  "thinking_of_your_career_in_commercial_real_estate_for_which_of_the_following_reasons_have_you_taken_jobs_with_new_companies_you_may_select_multiple_categories_the_new_position_offered_a_greater_opportunity_for_advancement" = "m12C[SQ002]",
  "thinking_of_your_career_in_commercial_real_estate_for_which_of_the_following_reasons_have_you_taken_jobs_with_new_companies_you_may_select_multiple_categories_the_new_company_allowed_you_to_be_flexible_with_your_schedule_and_work_location" = "m12C[SQ003]",
  "thinking_of_your_career_in_commercial_real_estate_for_which_of_the_following_reasons_have_you_taken_jobs_with_new_companies_you_may_select_multiple_categories_better_compensation_structure" = "m12C[SQ004]",
  "thinking_of_your_career_in_commercial_real_estate_for_which_of_the_following_reasons_have_you_taken_jobs_with_new_companies_you_may_select_multiple_categories_lost_your_prior_job_moved_layoffs_office_closed" = "m12C[SQ005]",
  "thinking_of_your_career_in_commercial_real_estate_for_which_of_the_following_reasons_have_you_taken_jobs_with_new_companies_you_may_select_multiple_categories_gain_collateral_experience" = "m12C[SQ006]",
  "thinking_of_your_career_in_commercial_real_estate_for_which_of_the_following_reasons_have_you_taken_jobs_with_new_companies_you_may_select_multiple_categories_other" = "m12C[SQ008]",
  "why_did_you_make_a_lateral_change_to_a_position_with_different_responsibilities_you_were_looking_for_a_change" = "m12B[SQ001]",
  "why_did_you_make_a_lateral_change_to_a_position_with_different_responsibilities_the_new_position_offered_a_greater_opportunity_for_advancement" = "m12B[SQ002]",
  "why_did_you_make_a_lateral_change_to_a_position_with_different_responsibilities_the_new_work_schedule_was_better_suited_to_your_family_personal_life" = "m12B[SQ003]",
  "why_did_you_make_a_lateral_change_to_a_position_with_different_responsibilities_better_compensation_structure" = "m12B[SQ004]",
  "why_did_you_make_a_lateral_change_to_a_position_with_different_responsibilities_wasn_t_your_choice_management_decision" = "m12B[SQ005]",
  "why_did_you_make_a_lateral_change_to_a_position_with_different_responsibilities_gain_collateral_experience" = "m12B[SQ006]",
  "why_did_you_make_a_lateral_change_to_a_position_with_different_responsibilities_other" = "m12B[SQ008]",
  "while_working_in_commercial_real_estate_have_you_ever_been_out_of_the_workforce_for_more_than_3_consecutive_months" = "m13A",
  "how_long_were_you_out_of_the_workforce_if_you_have_taken_multiple_leaves_from_the_workforce_please_consider_the_most_recent_years" = "m13B[SQ001]",
  "how_long_were_you_out_of_the_workforce_if_you_have_taken_multiple_leaves_from_the_workforce_please_consider_the_most_recent_months" = "m13B[SQ002]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_if_you_have_taken_multiple_leaves_from_the_workforce_please_consider_the_most_recent_you_may_select_multiple_categories_family_illness" = "m13C[SQ001]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_if_you_have_taken_multiple_leaves_from_the_workforce_please_consider_the_most_recent_you_may_select_multiple_categories_education" = "m13C[SQ002]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_if_you_have_taken_multiple_leaves_from_the_workforce_please_consider_the_most_recent_you_may_select_multiple_categories_voluntary_time_between_jobs" = "m13C[SQ003]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_if_you_have_taken_multiple_leaves_from_the_workforce_please_consider_the_most_recent_you_may_select_multiple_categories_travel" = "m13C[SQ004]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_if_you_have_taken_multiple_leaves_from_the_workforce_please_consider_the_most_recent_you_may_select_multiple_categories_new_child" = "m13C[SQ005]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_if_you_have_taken_multiple_leaves_from_the_workforce_please_consider_the_most_recent_you_may_select_multiple_categories_personal_illness" = "m13C[SQ006]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_if_you_have_taken_multiple_leaves_from_the_workforce_please_consider_the_most_recent_you_may_select_multiple_categories_involuntary_time_between_jobs_unemployment" = "m13C[SQ007]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_if_you_have_taken_multiple_leaves_from_the_workforce_please_consider_the_most_recent_you_may_select_multiple_categories_circumstances_related_to_the_pandemic" = "m13C[SQ008]",
  "what_reason_s_did_you_have_for_taking_time_out_of_the_workforce_if_you_have_taken_multiple_leaves_from_the_workforce_please_consider_the_most_recent_you_may_select_multiple_categories_other" = "m13C[other]",
  "when_you_returned_to_the_workforce_did_you_return_to_the_same_employer_that_you_had_previously_worked_for_if_you_have_taken_multiple_leaves_from_the_workforce_please_consider_the_most_recent" = "m13D",
  "and_while_out_of_the_workforce_did_your_employer" = "m13E",
  "the_following_questions_relate_to_compensation_please_select_the_currency_you_will_be_using_to_answer_these_questions_must_be_the_same_for_all_questions_if_the_currency_in_which_you_are_paid_is_not_here_please_coose_one_of_the_currencies_below_and_provide_an_approximation_at_current_exchange_rates" = "CUR",
  "thinking_only_about_your_total_annual_compensation_in_calendar_year_2024_how_was_your_gross_annual_compensation_distributed_base_salary_annual_fixed_cash_payout_cur_shown" = "m21A[1_SQ001]",
  "thinking_only_about_your_total_annual_compensation_in_calendar_year_2024_how_was_your_gross_annual_compensation_distributed_short_term_incentive_bonus_an_annual_performance_award_cur_shown" = "m21A[2_SQ001]",
  "thinking_only_about_your_total_annual_compensation_in_calendar_year_2024_how_was_your_gross_annual_compensation_distributed_commission_cur_shown" = "m21A[3_SQ001]",
  "thinking_only_about_your_total_annual_compensation_in_calendar_year_2024_how_was_your_gross_annual_compensation_distributed_profit_sharing_equitable_share_of_profits_cur_shown" = "m21A[4_SQ001]",
  "thinking_only_about_your_total_annual_compensation_in_calendar_year_2024_how_was_your_gross_annual_compensation_distributed_long_term_incentive_compensation_cur_shown" = "m21A[5_SQ001]",
  "comparing_calendar_year_2024_compensation_to_calendar_year_2023_compensation_what_was_the_percentage_change_in_your_total_annual_compensation" = "m22A",
  "by_how_much_did_it_increase_132" = "G14Q72",
  "by_how_much_did_it_decrease_133" = "G14Q73",
  "in_comparing_your_projected_2025_total_annual_compensation_to_your_2024_total_annual_compensation_what_percentage_change_do_you_anticipate_if_it_changed_please_enter_by_how_much" = "m22C",
  "by_how_much_did_it_decrease_135" = "G14Q80",
  "by_how_much_did_it_increase_136" = "G14Q79",
  "in_the_future_will_you_consider_accepting_a_new_position_that_includes_commission_as_part_of_your_overall_compensation" = "m23B",
  "which_of_the_statements_best_describes_the_role_of_compensation_structure_in_your_personal_career_path" = "m24",
  "please_confirm_and_re_enter_your_gross_pre_tax_total_annual_compensation_in_calendar_year_2024_including_base_salary_bonuses_commissions_profit_sharing_and_long_term_incentive_compensation" = "m28B",
  "has_your_compensation_and_or_career_advancement_been_adversely_impacted_by_your_marital_family_status_or_care_of_family" = "m21E",
  "please_rate_each_option_based_on_what_you_believe_are_significant_barriers_to_your_career_success_in_commercial_real_estate_please_complete_all_rows_for_the_following_questions_lack_of_an_undergraduate_degree" = "m21G[1]",
  "please_rate_each_option_based_on_what_you_believe_are_significant_barriers_to_your_career_success_in_commercial_real_estate_please_complete_all_rows_for_the_following_questions_lack_of_an_advanced_degree" = "m21G[2]",
  "please_rate_each_option_based_on_what_you_believe_are_significant_barriers_to_your_career_success_in_commercial_real_estate_please_complete_all_rows_for_the_following_questions_constraints_resulting_from_family_parenting_responsibilities" = "m21G[3]",
  "please_rate_each_option_based_on_what_you_believe_are_significant_barriers_to_your_career_success_in_commercial_real_estate_please_complete_all_rows_for_the_following_questions_gender_discrimination" = "m21G[4]",
  "please_rate_each_option_based_on_what_you_believe_are_significant_barriers_to_your_career_success_in_commercial_real_estate_please_complete_all_rows_for_the_following_questions_age_discrimination" = "m21G[5]",
  "please_rate_each_option_based_on_what_you_believe_are_significant_barriers_to_your_career_success_in_commercial_real_estate_please_complete_all_rows_for_the_following_questions_ethnic_racial_or_background_discrimination" = "m21G[6]",
  "please_rate_each_option_based_on_what_you_believe_are_significant_barriers_to_your_career_success_in_commercial_real_estate_please_complete_all_rows_for_the_following_questions_your_choice_to_maintain_work_and_life_balance" = "m21G[7]",
  "please_rate_each_option_based_on_what_you_believe_are_significant_barriers_to_your_career_success_in_commercial_real_estate_please_complete_all_rows_for_the_following_questions_limited_access_to_decision_makers" = "m21G[8]",
  "please_rate_each_option_based_on_what_you_believe_are_significant_barriers_to_your_career_success_in_commercial_real_estate_please_complete_all_rows_for_the_following_questions_lack_of_company_mentor_sponsor" = "m21G[9]",
  "please_rate_each_option_based_on_what_you_believe_are_significant_barriers_to_your_career_success_in_commercial_real_estate_please_complete_all_rows_for_the_following_questions_lack_of_specific_professional_technical_skills" = "m21G[10]",
  "please_rate_each_option_based_on_what_you_believe_are_significant_barriers_to_your_career_success_in_commercial_real_estate_please_complete_all_rows_for_the_following_questions_lack_of_profit_and_loss_responsibility" = "m21G[12]",
  "please_rate_each_option_based_on_what_you_believe_are_significant_barriers_to_your_career_success_in_commercial_real_estate_please_complete_all_rows_for_the_following_questions_lack_of_promotion_opportunity" = "m21G[13]",
  "please_rate_each_option_based_on_what_you_believe_are_significant_barriers_to_your_career_success_in_commercial_real_estate_please_complete_all_rows_for_the_following_questions_wrong_poor_choice_of_employer_company_downsizing_bankruptcy_etc" = "m21G[14]",
  "please_rate_each_option_based_on_what_you_believe_are_significant_barriers_to_your_career_success_in_commercial_real_estate_please_complete_all_rows_for_the_following_questions_lack_of_international_experience" = "m21G[15]",
  "please_rate_each_option_based_on_what_you_believe_are_significant_barriers_to_your_career_success_in_commercial_real_estate_please_complete_all_rows_for_the_following_questions_other" = "m21G[16]",
  "in_order_to_achieve_future_advancement_and_career_acceleration_to_more_senior_positions_what_contributing_factors_do_you_think_will_be_most_influential_for_you_relationship_with_internal_senior_executive_mentor" = "m21I[1]",
  "in_order_to_achieve_future_advancement_and_career_acceleration_to_more_senior_positions_what_contributing_factors_do_you_think_will_be_most_influential_for_you_external_mentorship" = "m21I[2]",
  "in_order_to_achieve_future_advancement_and_career_acceleration_to_more_senior_positions_what_contributing_factors_do_you_think_will_be_most_influential_for_you_professional_association_membership" = "m21I[3]",
  "in_order_to_achieve_future_advancement_and_career_acceleration_to_more_senior_positions_what_contributing_factors_do_you_think_will_be_most_influential_for_you_updated_technical_skills_it_computer" = "m21I[4]",
  "in_order_to_achieve_future_advancement_and_career_acceleration_to_more_senior_positions_what_contributing_factors_do_you_think_will_be_most_influential_for_you_business_referrals_from_peers" = "m21I[5]",
  "in_order_to_achieve_future_advancement_and_career_acceleration_to_more_senior_positions_what_contributing_factors_do_you_think_will_be_most_influential_for_you_graduate_school_educational_certificate_programs" = "m21I[6]",
  "in_order_to_achieve_future_advancement_and_career_acceleration_to_more_senior_positions_what_contributing_factors_do_you_think_will_be_most_influential_for_you_professional_networking" = "m21I[7]",
  "in_order_to_achieve_future_advancement_and_career_acceleration_to_more_senior_positions_what_contributing_factors_do_you_think_will_be_most_influential_for_you_stronger_communication_presentation_skills" = "m21I[8]",
  "in_order_to_achieve_future_advancement_and_career_acceleration_to_more_senior_positions_what_contributing_factors_do_you_think_will_be_most_influential_for_you_improved_financial_analytic_skills" = "m21I[9]",
  "in_order_to_achieve_future_advancement_and_career_acceleration_to_more_senior_positions_what_contributing_factors_do_you_think_will_be_most_influential_for_you_company_diversity_initiatives" = "m21I[10]",
  "in_order_to_achieve_future_advancement_and_career_acceleration_to_more_senior_positions_what_contributing_factors_do_you_think_will_be_most_influential_for_you_advancing_through_job_change_rather_than_current_company_promotion" = "m21I[11]",
  "in_order_to_achieve_future_advancement_and_career_acceleration_to_more_senior_positions_what_contributing_factors_do_you_think_will_be_most_influential_for_you_business_development_revenue_generation" = "m21I[12]",
  "in_order_to_achieve_future_advancement_and_career_acceleration_to_more_senior_positions_what_contributing_factors_do_you_think_will_be_most_influential_for_you_additional_language_skills" = "m21I[13]",
  "in_order_to_achieve_future_advancement_and_career_acceleration_to_more_senior_positions_what_contributing_factors_do_you_think_will_be_most_influential_for_you_effective_negotiation_skills" = "m21I[14]",
  "in_order_to_achieve_future_advancement_and_career_acceleration_to_more_senior_positions_what_contributing_factors_do_you_think_will_be_most_influential_for_you_career_coaching" = "m21I[15]",
  "please_rate_what_you_believe_are_the_most_important_factors_that_have_contributed_to_your_personal_career_success_in_commercial_real_estate_quality_or_prestige_of_undergraduate_academic_credentials" = "m21H[1]",
  "please_rate_what_you_believe_are_the_most_important_factors_that_have_contributed_to_your_personal_career_success_in_commercial_real_estate_quality_of_graduate_school_academics_and_network" = "m21H[2]",
  "please_rate_what_you_believe_are_the_most_important_factors_that_have_contributed_to_your_personal_career_success_in_commercial_real_estate_professional_association_membership" = "m21H[4]",
  "please_rate_what_you_believe_are_the_most_important_factors_that_have_contributed_to_your_personal_career_success_in_commercial_real_estate_business_networking_activities" = "m21H[5]",
  "please_rate_what_you_believe_are_the_most_important_factors_that_have_contributed_to_your_personal_career_success_in_commercial_real_estate_opportunities_to_develop_leadership_and_networking_skills" = "m21H[6]",
  "please_rate_what_you_believe_are_the_most_important_factors_that_have_contributed_to_your_personal_career_success_in_commercial_real_estate_community_social_group_activities" = "m21H[7]",
  "please_rate_what_you_believe_are_the_most_important_factors_that_have_contributed_to_your_personal_career_success_in_commercial_real_estate_company_sponsored_training_programs" = "m21H[8]",
  "please_rate_what_you_believe_are_the_most_important_factors_that_have_contributed_to_your_personal_career_success_in_commercial_real_estate_professional_certifications_leed_sior_ccim_wbe_etc" = "m21H[9]",
  "please_rate_what_you_believe_are_the_most_important_factors_that_have_contributed_to_your_personal_career_success_in_commercial_real_estate_company_diversity_initiatives" = "m21H[10]",
  "please_rate_what_you_believe_are_the_most_important_factors_that_have_contributed_to_your_personal_career_success_in_commercial_real_estate_mentor_support_external_to_your_firm" = "m21H[11]",
  "please_rate_what_you_believe_are_the_most_important_factors_that_have_contributed_to_your_personal_career_success_in_commercial_real_estate_mentor_support_relationship_with_corporate_champion_executive_inside_your_firm_sponsor" = "m21H[12]",
  "please_rate_what_you_believe_are_the_most_important_factors_that_have_contributed_to_your_personal_career_success_in_commercial_real_estate_right_time_right_place_selection_of_employer" = "m21H[13]",
  "please_rate_what_you_believe_are_the_most_important_factors_that_have_contributed_to_your_personal_career_success_in_commercial_real_estate_working_harder_than_anyone_else" = "m21H[14]",
  "please_rate_what_you_believe_are_the_most_important_factors_that_have_contributed_to_your_personal_career_success_in_commercial_real_estate_working_smarter_than_anyone_else" = "m21H[15]",
  "using_a_10_point_scale_where_10_indicates_very_important_and_1_not_at_all_important_how_important_is_each_of_the_following_to_you_the_amount_of_time_available_to_spend_with_your_family" = "m14A[SQ001]",
  "using_a_10_point_scale_where_10_indicates_very_important_and_1_not_at_all_important_how_important_is_each_of_the_following_to_you_the_amount_of_time_available_for_personal_activities" = "m14A[SQ002]",
  "using_a_10_point_scale_where_10_indicates_very_important_and_1_not_at_all_important_how_important_is_each_of_the_following_to_you_your_level_of_retirement_security" = "m14A[SQ003]",
  "using_a_10_point_scale_where_10_indicates_very_important_and_1_not_at_all_important_how_important_is_each_of_the_following_to_you_the_respect_of_your_co_workers" = "m14A[SQ004]",
  "using_a_10_point_scale_where_10_indicates_very_important_and_1_not_at_all_important_how_important_is_each_of_the_following_to_you_being_respected_in_the_community" = "m14A[SQ005]",
  "using_a_10_point_scale_where_10_indicates_very_important_and_1_not_at_all_important_how_important_is_each_of_the_following_to_you_the_level_of_achievement_reached_in_your_career" = "m14A[SQ006]",
  "using_a_10_point_scale_where_10_indicates_very_important_and_1_not_at_all_important_how_important_is_each_of_the_following_to_you_the_level_of_enjoyment_your_job_brings" = "m14A[SQ008]",
  "using_a_10_point_scale_where_10_indicates_very_important_and_1_not_at_all_important_how_important_is_each_of_the_following_to_you_working_in_a_role_that_maximizes_your_earnings_potential" = "m14A[SQ009]",
  "using_a_10_point_scale_where_10_indicates_very_important_and_1_not_at_all_important_how_important_is_each_of_the_following_to_you_working_in_team_oriented_environment" = "m14A[SQ010]",
  "using_a_10_point_scale_where_10_indicates_very_important_and_1_not_at_all_important_how_important_is_each_of_the_following_to_you_being_challenged_by_your_job" = "m14A[SQ012]",
  "using_a_10_point_scale_where_10_indicates_very_important_and_1_not_at_all_important_how_important_is_each_of_the_following_to_you_being_a_decision_maker_in_your_organization" = "m14A[SQ013]",
  "using_a_10_point_scale_where_10_indicates_very_important_and_1_not_at_all_important_how_important_is_each_of_the_following_to_you_having_a_clear_career_path" = "m14A[SQ014]",
  "using_a_10_point_scale_where_10_indicates_very_satisfied_and_1_not_at_all_satisfied_please_indicate_your_current_level_of_satisfaction_with_each_of_the_following_the_respect_of_your_co_workers" = "m14B[SQ001]",
  "using_a_10_point_scale_where_10_indicates_very_satisfied_and_1_not_at_all_satisfied_please_indicate_your_current_level_of_satisfaction_with_each_of_the_following_your_level_of_decision_making_in_your_organization" = "m14B[SQ002]",
  "using_a_10_point_scale_where_10_indicates_very_satisfied_and_1_not_at_all_satisfied_please_indicate_your_current_level_of_satisfaction_with_each_of_the_following_your_level_of_retirement_security" = "m14B[SQ004]",
  "using_a_10_point_scale_where_10_indicates_very_satisfied_and_1_not_at_all_satisfied_please_indicate_your_current_level_of_satisfaction_with_each_of_the_following_the_amount_of_time_available_for_personal_activities" = "m14B[SQ005]",
  "using_a_10_point_scale_where_10_indicates_very_satisfied_and_1_not_at_all_satisfied_please_indicate_your_current_level_of_satisfaction_with_each_of_the_following_the_level_of_achievement_reached_in_your_career" = "m14B[SQ007]",
  "using_a_10_point_scale_where_10_indicates_very_satisfied_and_1_not_at_all_satisfied_please_indicate_your_current_level_of_satisfaction_with_each_of_the_following_working_in_team_oriented_environment" = "m14B[SQ008]",
  "using_a_10_point_scale_where_10_indicates_very_satisfied_and_1_not_at_all_satisfied_please_indicate_your_current_level_of_satisfaction_with_each_of_the_following_having_a_clear_career_path" = "m14B[SQ009]",
  "using_a_10_point_scale_where_10_indicates_very_satisfied_and_1_not_at_all_satisfied_please_indicate_your_current_level_of_satisfaction_with_each_of_the_following_your_level_of_respect_in_the_community" = "m14B[SQ010]",
  "using_a_10_point_scale_where_10_indicates_very_satisfied_and_1_not_at_all_satisfied_please_indicate_your_current_level_of_satisfaction_with_each_of_the_following_that_your_role_maximizes_your_earnings_potential" = "m14B[SQ011]",
  "using_a_10_point_scale_where_10_indicates_very_satisfied_and_1_not_at_all_satisfied_please_indicate_your_current_level_of_satisfaction_with_each_of_the_following_the_level_of_enjoyment_your_job_brings" = "m14B[SQ012]",
  "using_a_10_point_scale_where_10_indicates_very_satisfied_and_1_not_at_all_satisfied_please_indicate_your_current_level_of_satisfaction_with_each_of_the_following_challenges_presented_by_your_job" = "m14B[SQ013]",
  "using_a_10_point_scale_where_10_indicates_very_satisfied_and_1_not_at_all_satisfied_please_indicate_your_current_level_of_satisfaction_with_each_of_the_following_the_amount_of_time_available_to_spend_with_your_family" = "m14B[SQ014]",
  "using_a_10_point_scale_where_10_is_high_success_and_1_is_low_success_what_level_of_overall_success_have_you_achieved_in_your_career" = "m15[SQ001]",
  "using_a_10_point_scale_where_10_indicates_very_satisfied_and_1_is_not_at_all_satisfied_how_satisfied_are_you_with_the_overall_level_of_success_you_have_achieved_in_your_career" = "m16[SQ001]",
  "using_a_10_point_scale_where_10_indicates_very_satisfied_and_1_is_not_at_all_satisfied_how_satisfied_are_you_with_the_balance_you_have_achieved_between_your_career_and_other_aspects_of_your_life" = "m16[SQ002]",
  "are_you_currently_a_member_of_a_chapter_of_crew_network" = "m19",
  "which_crew_network_are_you_a_member_of" = "G17Q67",
  "does_your_company_have_any_programs_in_place_that_are_aimed_at_advancing_the_careers_of_the_following_groups_please_fill_out_each_collum_women" = "m17[SQ001]",
  "does_your_company_have_any_programs_in_place_that_are_aimed_at_advancing_the_careers_of_the_following_groups_please_fill_out_each_collum_minority_race_ethnicity_origins_employees" = "m17[SQ002]",
  "does_your_company_have_any_programs_in_place_that_are_aimed_at_advancing_the_careers_of_the_following_groups_please_fill_out_each_collum_lgbtq_employees" = "m17[SQ003]",
  "does_your_company_have_any_programs_in_place_that_are_aimed_at_advancing_the_careers_of_the_following_groups_please_fill_out_each_collum_workers_with_special_needs" = "m17[SQ004]",
  "does_your_company_have_any_programs_in_place_that_are_aimed_at_advancing_the_careers_of_the_following_groups_please_fill_out_each_collum_veterans" = "m17[SQ005]",
  "since_2020_has_gender_equity_in_your_firm_increased_in_terms_of_equal_opportunities_advancement_support_culture_and_compensation_for_women" = "m21J",
  "in_terms_of_race_ethnicity_and_origin_of_employees_which_of_the_following_best_describes_your_workplace" = "m21Li",
  "in_the_past_12_months_how_often_did_someone_at_work_make_unwanted_attempts_to_establish_a_sexual_relationship_with_you_despite_your_efforts_to_discourage_these_attempts_or_express_disinterest_or_touch_you_in_a_way_that_made_you_feel_uncomfortable" = "m21Kii",
  "in_the_past_12_months_how_often_did_someone_at_work_tell_sexist_stories_or_jokes_that_were_offensive_to_you_or_make_offensive_remarks_about_your_appearance_body_or_sexual_activities_or_refer_to_people_of_your_gender_in_insulting_or_offensive_terms_or_put_you_down_or_act_in_a_condescending_way_toward_you_because_of_your_gender" = "M21Ki",
  "which_of_the_following_ranges_best_describes_your_age_group" = "m25",
  "i_identify_my_ethnicity_as" = "G20Q70",
  "choose_one_category_below_to_best_describe_your_ethnic_group_or_background" = "G20Q69",
  "which_one_do_you_regard_as_the_main_ethnic_or_cultural_origin_of_your_ancestors" = "G20Q68",
  "do_you_consider_yourself_afromexican" = "G20Q71",
  "do_you_consider_yourself_an_indigenous_person" = "G20Q72",
  "which_of_the_following_best_describes_you" = "m27b",
  "what_is_your_gender_identity" = "m27",
  "what_is_the_highest_level_of_education_that_you_have_completed" = "m28A",
  "in_the_recent_years_we_have_seen_notable_changes_in_the_ways_people_work_can_you_indicate_how_long_is_your_work_week_if_you_are_working_remotely_how_many_hours_you_spend_working_at_home_or_in_a_private_workspace_e_g_library_or_a_relative_s_home_excluding_remote_work_how_long_do_you_spend_working_in_the_field_e_g_visiting_properties_or_clients_average_hours_per_week_in_the_office_hours_per_week" = "HOURS[SQ001_SQ001]",
  "in_the_recent_years_we_have_seen_notable_changes_in_the_ways_people_work_can_you_indicate_how_long_is_your_work_week_if_you_are_working_remotely_how_many_hours_you_spend_working_at_home_or_in_a_private_workspace_e_g_library_or_a_relative_s_home_excluding_remote_work_how_long_do_you_spend_working_in_the_field_e_g_visiting_properties_or_clients_average_hours_per_week_working_remotely_from_home_hours_per_week" = "HOURS[SQ002_SQ001]",
  "in_the_recent_years_we_have_seen_notable_changes_in_the_ways_people_work_can_you_indicate_how_long_is_your_work_week_if_you_are_working_remotely_how_many_hours_you_spend_working_at_home_or_in_a_private_workspace_e_g_library_or_a_relative_s_home_excluding_remote_work_how_long_do_you_spend_working_in_the_field_e_g_visiting_properties_or_clients_average_hours_per_week_of_fieldwork_not_in_the_office_or_from_home_hours_per_week" = "HOURS[SQ003_SQ001]",
  "x5_years_later_how_has_the_covid_epidemic_changed_the_trajectory_of_your_career_and_your_satisfaction_with_your_workplace_please_select_yes_or_no_to_the_items_below_increased_flexibility_and_work_life_balance" = "COVID1[SQ003]",
  "x5_years_later_how_has_the_covid_epidemic_changed_the_trajectory_of_your_career_and_your_satisfaction_with_your_workplace_please_select_yes_or_no_to_the_items_below_reduced_meaningful_interactions_with_colleagues" = "COVID1[SQ004]",
  "x5_years_later_how_has_the_covid_epidemic_changed_the_trajectory_of_your_career_and_your_satisfaction_with_your_workplace_please_select_yes_or_no_to_the_items_below_impeded_or_delayed_advancement" = "COVID1[SQ005]",
  "x5_years_later_how_has_the_covid_epidemic_changed_the_trajectory_of_your_career_and_your_satisfaction_with_your_workplace_please_select_yes_or_no_to_the_items_below_made_your_work_harder_due_to_increased_turnover_in_your_company" = "COVID1[SQ006]",
  "x5_years_later_how_has_the_covid_epidemic_changed_the_trajectory_of_your_career_and_your_satisfaction_with_your_workplace_please_select_yes_or_no_to_the_items_below_opened_professional_opportunities_outside_of_your_firm" = "COVID1[SQ007]",
  "x5_years_later_how_has_the_covid_epidemic_changed_the_trajectory_of_your_career_and_your_satisfaction_with_your_workplace_please_select_yes_or_no_to_the_items_below_limited_access_to_clients_or_connections" = "COVID1[SQ008]",
  "x5_years_later_how_has_the_covid_epidemic_changed_the_trajectory_of_your_career_and_your_satisfaction_with_your_workplace_please_select_yes_or_no_to_the_items_below_made_you_more_productive" = "COVID1[SQ009]",
  "x5_years_later_how_has_the_covid_epidemic_changed_the_trajectory_of_your_career_and_your_satisfaction_with_your_workplace_please_select_yes_or_no_to_the_items_below_generated_more_stress_or_mental_fatigue" = "COVID1[SQ010]",
  "x5_years_later_how_has_the_covid_epidemic_changed_the_trajectory_of_your_career_and_your_satisfaction_with_your_workplace_please_select_yes_or_no_to_the_items_below_other_please_specify" = "COVID1[SQ011]",
  "if_other_please_specify_below" = "G21Q74"
)

rename_to_keycodes <- function(data, mapping) {
  current_names <- colnames(data)
  new_names <- current_names
  
  successful_mappings <- 0
  failed_mappings <- c()
  
  for (i in seq_along(current_names)) {
    current_name <- current_names[i]
    if (current_name %in% names(mapping)) {
      new_names[i] <- mapping[[current_name]]
      successful_mappings <- successful_mappings + 1
    } else {
      failed_mappings <- c(failed_mappings, current_name)
    }
  }
  
  colnames(data) <- new_names
  
  cat("Column Renaming Summary:\n")
  cat("- Successfully renamed:", successful_mappings, "columns\n")
  cat("- Failed to find mapping for:", length(failed_mappings), "columns\n")
  
  if (length(failed_mappings) > 0) {
    cat("\nColumns without mappings:\n")
    for (i in seq_along(failed_mappings)) {
      cat(sprintf("%d. %s\n", i, failed_mappings[i]))
    }
  }
  
  return(data)
}

data_with_keycodes <- rename_to_keycodes(data, cleaned_to_keycode)

saveRDS(data_with_keycodes, "crew_dataset_keys_analysis_ready.rds")

write.csv(data_with_keycodes, "crew_datset_keys_analysis_ready.csv", row.names = FALSE)

# cat("\nFirst 15 renamed columns (key codes):\n")
# head_cols <- head(colnames(data_with_keycodes), 15)
# for (i in seq_along(head_cols)) {
#   cat(sprintf("%d. %s\n", i, head_cols[i]))
# }
# 
# cat("\nLast 10 renamed columns (key codes):\n")
# tail_cols <- tail(colnames(data_with_keycodes), 10)
# start_index <- length(colnames(data_with_keycodes)) - 9
# for (i in seq_along(tail_cols)) {
#   cat(sprintf("%d. %s\n", start_index + i - 1, tail_cols[i]))
# }

# names(data_with_keycodes)
